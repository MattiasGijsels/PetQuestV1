@page "/admin-control-panel"
@inherits PetQuestV1.Components.Pages.AdminControlPanelBase
@rendermode InteractiveServer

<h3 class="mb-4">Admin Control Panel</h3>

<!-- ================= Pets section ================ -->
<div class="card mb-5">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Pets</h5>
        <button class="btn btn-sm btn-success" @onclick="ShowAddPetForm">
            <i class="bi bi-plus"></i> Add New Pet
        </button>
    </div>
    <div class="card-body p-0">
        @if (IsPetFormVisible)
        {
            <EditForm Model="PetFormModel" OnValidSubmit="HandlePetFormSubmit" class="p-3 border-bottom">
                <div class="row g-2 mb-2">
                    <div class="col-sm-4">
                        <InputText class="form-control" @bind-Value="PetFormModel.PetName" placeholder="Name" />
                    </div>
                    <div class="col-sm-4">
                        <InputText class="form-control" @bind-Value="PetFormModel.SpeciesId" placeholder="Species ID" />
                    </div>
                    <div class="col-sm-4">
                        <InputText class="form-control" @bind-Value="PetFormModel.OwnerId" placeholder="Owner ID" />
                    </div>
                </div>
                <button type="submit" class="btn btn-primary btn-sm me-2">Save</button>
                <button type="button" class="btn btn-secondary btn-sm" @onclick="CancelPetForm">Cancel</button>
            </EditForm>
        }

        <table class="table table-striped table-hover mb-0 admin-table">
            <thead class="table-light">
                <tr>
                    <th>Name</th>
                    <th>Species</th>
                    <th>Owner</th>
                    <th style="width: 120px">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var pet in PagedPets)
                {
                    <tr>
                        <td>@pet.PetName</td>
                        <td>@pet.Species?.Name</td>
                        <td>@pet.Owner?.UserName</td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary me-1" @onclick="() => EditPet(pet)"><i class="bi bi-pencil"></i></button>
                            <button class="btn btn-sm btn-outline-danger" @onclick="() => DeletePet(pet.Id)"><i class="bi bi-trash"></i></button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>

        <!-- Pets pagination -->
        <nav class="p-2 border-top d-flex justify-content-center">
            <ul class="pagination pagination-sm mb-0">
                <li class="page-item @(PetsCurrentPage == 1 ? "disabled" : string.Empty)">
                    <a class="page-link" @onclick="() => ChangePetsPage(PetsCurrentPage - 1)">Prev</a>
                </li>
                @for (int i = 1; i <= PetsTotalPages; i++)
                {
                    <li class="page-item @(PetsCurrentPage == i ? "active" : string.Empty)">
                        <a class="page-link" @onclick="() => ChangePetsPage(i)">@i</a>
                    </li>
                }
                <li class="page-item @(PetsCurrentPage == PetsTotalPages ? "disabled" : string.Empty)">
                    <a class="page-link" @onclick="() => ChangePetsPage(PetsCurrentPage + 1)">Next</a>
                </li>
            </ul>
        </nav>
    </div>
</div>

<!-- ================= Users section ================ -->
<div class="card">
    <div class="card-header">
        <h5 class="mb-0">Users</h5>
    </div>
    <div class="card-body p-0">
        <table class="table table-striped table-hover mb-0 admin-table">
            <thead class="table-light">
                <tr>
                    <th>User Name</th>
                    <th>Email</th>
                    <th style="width: 120px">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var user in PagedUsers)
                {
                    <tr>
                        <td>@user.UserName</td>
                        <td>@user.Email</td>
                        <td>
                            <!-- placeholder for future user CRUD buttons -->
                            <button class="btn btn-sm btn-outline-secondary" disabled><i class="bi bi-pencil"></i></button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>

        <!-- Users pagination -->
        <nav class="p-2 border-top d-flex justify-content-center">
            <ul class="pagination pagination-sm mb-0">
                <li class="page-item @(UsersCurrentPage == 1 ? "disabled" : string.Empty)">
                    <a class="page-link" @onclick="() => ChangeUsersPage(UsersCurrentPage - 1)">Prev</a>
                </li>
                @for (int i = 1; i <= UsersTotalPages; i++)
                {
                    <li class="page-item @(UsersCurrentPage == i ? "active" : string.Empty)">
                        <a class="page-link" @onclick="() => ChangeUsersPage(i)">@i</a>
                    </li>
                }
                <li class="page-item @(UsersCurrentPage == UsersTotalPages ? "disabled" : string.Empty)">
                    <a class="page-link" @onclick="() => ChangeUsersPage(UsersCurrentPage + 1)">Next</a>
                </li>
            </ul>
        </nav>
    </div>
</div>

<style>
    .admin-table th {
        background-color: #f8f9fa;
    }
</style>